# Process for building UPF on Raspberry PI

The installations procedure is straight forward and can be followed from the main free5GC website.

But i encountered the following errors while configuring Raspberry PI as UPF, since RPI is arm architecture based and needs special tweaks.

Followiing are the the erros are I encountered with the solutions that worked for me for those errors :

### 1. The specific Kernel headers were not there in RPI

```error
make -C /lib/modules/5.10.103-v7l+/build M=/home/pi/free5gc-UPF/gtp5g modules
make[1]: *** /lib/modules/5.10.103-v7l+/build: No such file or directory.  Stop.
make: *** [Makefile:83: module] Error 2
```

To solve this issue run the follow command :

```
sudo apt-get install raspberrypi-kernel-headers
```

### 2. go Exec Error

If you are getting go Exec error, install the go using the following method :

<a href="https://bit.ly/JMYouTubeLive" style="box-sizing: border-box; color: blue; transition: color 0.35s ease 0s; text-decoration: none; font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255);"><img src="https://www.jeremymorgan.com/images/banners/jeremyyoutube.webp" alt="Check out my YouTube Channel!" style="box-sizing: border-box; max-width: 100%;"></a><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">If you want to install Go on your Raspberry Pi you have a few options. In the past there was a lot of cross compiling and hacking to get it done, but now you can install it through Apt. However, you’re likely to find an older version.</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://www.jeremymorgan.com/images/install-go-raspberry-pi/install-go-raspberry-pi-01.jpg" alt="How to install Go on Raspberry Pi" style="box-sizing: border-box; max-width: 100%;"></p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">For instance at the time of this writing, an updated Raspberry Pi OS shows a version of 1.11.1 in the repositories. However the current version is 1.14.3 so if the latest version is important to you, here’s your solution.</p><h2 id="step-1-get-the-latest-package" style="box-sizing: border-box; color: rgb(33, 33, 33); font-family: sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Step 1: Get the Latest Package</h2><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">To get the latest version, browse on over to the<span>&nbsp;</span><a href="https://golang.org/dl/" style="box-sizing: border-box; color: blue; transition: color 0.35s ease 0s; text-decoration: none;">Go download page</a><span>&nbsp;</span>and look for the latest version.</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://www.jeremymorgan.com/images/install-go-raspberry-pi/install-go-raspberry-pi-02.jpg" alt="How to install Go on Raspberry Pi" style="box-sizing: border-box; max-width: 100%;"></p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Look for the “ARM v6 version” for the Raspberry Pi.</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">My current archive is<span>&nbsp;</span><a href="https://dl.google.com/go/go1.14.4.linux-armv6l.tar.gz" style="box-sizing: border-box; color: blue; transition: color 0.35s ease 0s; text-decoration: none;">https://dl.google.com/go/go1.14.4.linux-armv6l.tar.gz</a></p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Whichever archive you choose, use wget to download it:</p><div class="highlight" style="box-sizing: border-box; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><pre class="chroma" style="box-sizing: border-box; overflow: auto; border-left: 0.4em solid rgba(23, 212, 252, 0.8); padding-left: 1em;"><code class="language-fallback" data-lang="fallback" style="box-sizing: border-box; font-size: 0.8em; font-family: &quot;courier new&quot;, Courier, monospace;">mkdir ~/src &amp;&amp; cd ~/src
wget https://dl.google.com/go/go1.14.4.linux-armv6l.tar.gz
</code></pre></div><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Now you have the latest package.</p><h2 id="step-2-extract-the-package" style="box-sizing: border-box; color: rgb(33, 33, 33); font-family: sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Step 2: Extract the Package</h2><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Now you’ll want to extract the package into your local folder:</p><div class="highlight" style="box-sizing: border-box; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><pre class="chroma" style="box-sizing: border-box; overflow: auto; border-left: 0.4em solid rgba(23, 212, 252, 0.8); padding-left: 1em;"><code class="language-fallback" data-lang="fallback" style="box-sizing: border-box; font-size: 0.8em; font-family: &quot;courier new&quot;, Courier, monospace;">sudo tar -C /usr/local -xzf go1.14.4.linux-armv6l.tar.gz
rm go1.14.4.linux-arm64.tar.gz
</code></pre></div><h2 id="step-3-configure-go" style="box-sizing: border-box; color: rgb(33, 33, 33); font-family: sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Step 3: Configure Go</h2><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Now you just need to configure it, which you have to do with any Go installation anyway.</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Open up your ~/.profile (Using nano, vi, etc)</p><div class="highlight" style="box-sizing: border-box; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><pre class="chroma" style="box-sizing: border-box; overflow: auto; border-left: 0.4em solid rgba(23, 212, 252, 0.8); padding-left: 1em;"><code class="language-fallback" data-lang="fallback" style="box-sizing: border-box; font-size: 0.8em; font-family: &quot;courier new&quot;, Courier, monospace;">vi ~/.profile
</code></pre></div><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">and add the following:</p><div class="highlight" style="box-sizing: border-box; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><pre class="chroma" style="box-sizing: border-box; overflow: auto; border-left: 0.4em solid rgba(23, 212, 252, 0.8); padding-left: 1em;"><code class="language-fallback" data-lang="fallback" style="box-sizing: border-box; font-size: 0.8em; font-family: &quot;courier new&quot;, Courier, monospace;">PATH=$PATH:/usr/local/go/bin
GOPATH=$HOME/go
</code></pre></div><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Notice here you can set your go path to whatever you like. I prefer /go, but you can put this wherever you want.</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Update your shell with your changes:</p><div class="highlight" style="box-sizing: border-box; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><pre class="chroma" style="box-sizing: border-box; overflow: auto; border-left: 0.4em solid rgba(23, 212, 252, 0.8); padding-left: 1em;"><code class="language-fallback" data-lang="fallback" style="box-sizing: border-box; font-size: 0.8em; font-family: &quot;courier new&quot;, Courier, monospace;">source ~/.profile
</code></pre></div><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">And check your version:</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><img src="https://www.jeremymorgan.com/images/install-go-raspberry-pi/install-go-raspberry-pi-03.jpg" alt="How to install Go on Raspberry Pi" style="box-sizing: border-box; max-width: 100%;"></p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">And you’re good to Go!</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Get it? Yeah I’ll show myself out.</p><p style="box-sizing: border-box; line-height: 1.4; color: rgb(45, 45, 46); font-family: sans-serif; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Enjoy!</p>

### 3. If you are getting go uint64 error

**Solution**

```yaml
The error you're seeing is due to the fact that the `github.com/khirono/go-nl` package is trying to assign a `uint64` value to a `uint32` variable. This is a type mismatch, and it's causing the build to fail.

This issue arises because the `len()` function in Go returns an `int` type, and in 64-bit systems, `int` is equivalent to `int64`. But the `github.com/khirono/go-nl` package expects a `uint32` type, hence the error.

Unfortunately, you cannot fix this issue directly as it's within the `github.com/khirono/go-nl` package itself. The package needs to be updated to handle `int64` values returned by `len()`.

However, you can try a workaround by modifying the package locally:

1. **Locate the Package**: Find the location of the `github.com/khirono/go-nl` package in your Go workspace. It should be under `$GOPATH/pkg/mod/github.com/khirono/go-nl@v1.0.5`.

2. **Edit the Code**: Open the `conn.go` and `request.go` files in a text editor and replace `uint64(len(...))` with `uint32(len(...))`. Be careful with this operation as it might introduce overflow errors if the length exceeds the maximum value of `uint32`.

3. **Recompile the Project**: Try building your project again. The error should no longer occur.

Keep in mind that this is a temporary workaround. The proper solution would be for the package author to update the package to handle `int64` values returned by `len()`. You might want to report this issue to the package maintainer [Source 2](https://pkg.go.dev/github.com/mdlayher/netlink), [Source 4](https://github.com/golang/go/issues/16500).
```

> Go version I used : 1.17.8
